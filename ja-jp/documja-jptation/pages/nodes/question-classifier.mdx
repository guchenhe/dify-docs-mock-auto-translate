```mdx
---
title: "質問分類器"
description: "ユーザー入力を知的に分類してワークフローパスをルート化する"
icon: "sitemap"
---

質問分類器ノードは、ユーザー入力を知的に分類して、異なるワークフローパスに会話をルート化します。複雑な条件ロジックを構築する代わりに、カテゴリを定義し、LLM が意味理解に基づいて最適なものを決定します。

## 設定

### 入力とモデルのセットアップ

**入力変数** - 分類する内容を選択します。通常はユーザーの質問に対する `sys.query` ですが、前のワークフローノードからの任意のテキスト変数も使用できます。

**モデル選択** - 分類のために LLM を選択します。シンプルなカテゴリには高速なモデルが適しており、より微妙な区別には強力なモデルが適しています。

<Frame caption="質問分類器の設定インターフェース">
  <img src="https://assets-docs.dify.ai/dify-enterprise-mintlify/en/guides/workflow/node/2f039c5ff3f095b0eed291101d9bff15.png" alt="質問分類器のセットアップ" />
</Frame>

### カテゴリ定義

各カテゴリに対して、具体的な説明を伴う明確で記述的なラベルを作成します。カテゴリ間の境界を明確にすることで、LLM が正確な決定を下せるようにします。

各カテゴリは、専門的な知識ベース、応答テンプレート、または処理ワークフローのような異なる下流ノードに接続できる潜在的な出力パスとなります。

## 分類例

以下は、カスタマーサービスのシナリオにおける質問分類器の動作例です：

<Frame caption="カスタマーサービス分類ワークフロー">
  <img src="https://assets-docs.dify.ai/dify-enterprise-mintlify/en/guides/workflow/node/2f06ecce149c844c23be70a8fcff09bc.png" alt="カスタマーサービス分類" />
</Frame>

**定義されたカテゴリ:**
- **アフターサービス** - 保証請求、返品、修理、購入後のサポート
- **製品使用** - セットアップ手順、トラブルシューティング、機能説明  
- **その他の質問** - 特定のカテゴリに該当しない一般的な問い合わせ

**分類結果:**
- "iPhone 14で連絡先をセットアップする方法は？" → **製品使用**
- "購入品の保証期間はどのくらいですか？" → **アフターサービス**  
- "今日の天気はどうですか？" → **その他の質問**

各分類結果は、異なる知識ベースや応答戦略にルート化され、ユーザーが関連する専門的な支援を受けられるようにします。

## 高度な設定

### 指示とガイドライン

**指示**フィールドに詳細な分類ガイドラインを追加して、エッジケース、不明瞭なシナリオ、または特定のビジネスルールを処理します。これにより、LLM はカテゴリ間の微妙な違いを理解できます。

### メモリ統合

**メモリ**を有効にして、分類時に会話履歴を含めます。これにより、現在の入力が前のコンテキストに依存するマルチターンの会話での精度が向上します。

**メモリウィンドウ**は、トークン効率と処理速度を考慮しつつ、どれだけの会話履歴を含めるかを制御します。

## 出力の使用

分類器は、一致したカテゴリラベルを含む `class_name` 変数を出力します。この変数を下流ノードで使用して：

**条件ルーティング** - 分類結果に基づいて異なるワークフローパスを接続

**知識ベース選択** - 各カテゴリに対応する専門知識ベースにルート化

**応答カスタマイズ** - 異なる応答テンプレートまたは処理ロジックを適用

**分析とログ** - カテゴリごとのユーザー問い合わせの分布を追跡

## ベストプラクティス

**明確なカテゴリ境界** - 特定の説明を持つ、重複しない明確なカテゴリを定義して、分類精度を向上させます。

**適切なモデル選択** - 分類の複雑さに基づいてモデルを選択します。シンプルな二項分類には高速なモデルが適しており、微妙な多カテゴリ分類にはより能力のあるモデルが必要です。

**エッジケースのテスト** - 複数のカテゴリに適合する可能性がある曖昧な入力で分類動作を確認します。

**会話コンテキストを利用** - 分類が過去の対話に依存する会話型アプリケーションではメモリを有効にします。

**監視と反復** - 分類結果をレビューし、実際の使用パターンに基づいてカテゴリ説明を改善します。
```