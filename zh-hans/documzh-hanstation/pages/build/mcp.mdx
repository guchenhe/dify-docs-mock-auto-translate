```mdx
---
title: "使用 MCP 工具"
icon: "microchip"
---

将外部工具从 [MCP 服务器](https://modelcontextprotocol.io/introduction) 连接到您的 Dify 应用程序。除了内置工具外，您还可以使用不断增长的 [MCP 生态系统](https://mcpservers.org/)中的工具。

<Note>
  本文涵盖在 Dify 中使用 MCP 工具。要将 Dify 应用程序发布为 MCP 服务器，请参见[此处](/en/guides/application-publishing/publish-mcp)。
</Note>

<Info>
  目前仅支持具有 [HTTP 传输](https://modelcontextprotocol.io/docs/concepts/architecture#transport-layer)的 MCP 服务器。
</Info>

## 添加 MCP 服务器

前往您的工作区中的 **工具** → **MCP**。

![](/images/6cef1436fcc13a65ccedb54bcf5ab77eb87b8faba1098a85951839fb1907f2d2.png)

点击 **添加 MCP 服务器 (HTTP)**：

![](/images/b5429131836c1caae84f4ce8b3b806221e39636723644961ce2f2a97d5421f16.png)

**服务器 URL**：MCP 服务器所在位置（例如 `https://api.notion.com/mcp`）

**名称和图标**：将其命名为有用的名称。Dify 会尝试自动获取图标。

**服务器 ID**：唯一标识符（小写字母、数字、下划线、连字符，最多 24 个字符）

<Warning>
  一旦开始使用，切勿更改服务器 ID。这将导致使用该服务器工具的应用程序无法运行。
</Warning>

## 接下来会发生什么

Dify 自动：
1. 连接到服务器
2. 处理任何 OAuth 相关问题
3. 获取可用工具列表
4. 在您的应用程序构建器中提供这些工具

一旦找到工具，您将看到一个服务器卡片：

![](/images/fcef5ecad1deca82a1d8988c4bcb7cec745a0cd47945ff05fca588502cfaafbc.png)

## 管理服务器

点击任何服务器卡片以：

**更新工具**：当外部服务添加新工具时刷新

![](/images/7b526a64ff34b10a357511b2cd3e42f251a6786210eac71c58ca7bfccdf63f0c.png)

**重新授权**：在令牌过期时修复授权

**编辑设置**：更改服务器详细信息（但不能更改 ID！）

**移除**：断开与服务器的连接（这将导致使用其工具的应用程序无法运行）

## 使用 MCP 工具

连接后，MCP 工具将在您期望的地方出现：

**在智能代理中**：工具按服务器分组显示（例如“Notion MCP » 创建页面”）

**在工作流中**：MCP 工具可用作节点

**在智能代理节点中**：与常规智能代理相同

## 自定义工具

添加 MCP 工具时，您可以自定义它：

![](/images/CleanShot2025-07-07at07.41.33@2x.png)

**描述**：覆盖默认描述以更具体

**参数**：对于每个工具参数，选择：
- **自动**：让 AI 决定值
- **固定**：设置一个永不改变的特定值

**示例**：对于搜索工具，将 `numResults` 设置为 5（固定），但将 `query` 保持为自动。

## 共享应用程序

当您导出使用 MCP 工具的应用程序时：
- 导出包括服务器 ID
- 要在其他地方使用应用程序，请添加具有相同 ID 的相同服务器
- 记录您的应用程序需要哪些 MCP 服务器

## 疑难解答

**“未配置的服务器”**：检查 URL 并重新授权

**缺少工具**：点击“更新工具”

**应用程序损坏**：您可能更改了服务器 ID。使用原始 ID 添加回去。

## 提示

- 使用永久性、描述性的服务器 ID，如 `github-prod` 或 `crm-system`
- 在开发/测试/生产环境中保持相同的 MCP 设置
- 为配置项目设置固定值，为动态输入保持自动
- 在部署前测试 MCP 集成
```