---
title: Advanced Setup Guide
description: Learn how to configure advanced settings for your Dify installation
---

<Info>
for workflow testing purpose!
</Info>

This guide covers advanced configuration options for Dify that go beyond the basic installation.

## Environment Variables

Configure these advanced environment variables for optimal performance:

### Database Configuration

```bash
# Database connection pooling
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20
DB_POOL_TIMEOUT=30

# Database performance tuning
DB_QUERY_TIMEOUT=60
DB_SLOW_QUERY_THRESHOLD=1000
```

### Redis Configuration

```bash
# Redis connection settings
REDIS_MAX_CONNECTIONS=100
REDIS_CONNECTION_TIMEOUT=5
REDIS_SOCKET_TIMEOUT=5

# Redis cluster settings
REDIS_CLUSTER_ENABLED=false
REDIS_CLUSTER_NODES=redis-1:6379,redis-2:6379,redis-3:6379
```

## Performance Optimization

### Memory Management

Configure memory settings based on your server specifications:

- **Small deployment (2-4GB RAM):** Set `WORKER_MEMORY_LIMIT=512MB`
- **Medium deployment (8-16GB RAM):** Set `WORKER_MEMORY_LIMIT=2GB`
- **Large deployment (32GB+ RAM):** Set `WORKER_MEMORY_LIMIT=4GB`

### CPU Optimization

Adjust worker processes based on CPU cores:

```bash
# Calculate optimal workers: CPU cores Ã— 2 + 1
WEB_WORKER_COUNT=5
CELERY_WORKER_COUNT=4
```

## Security Hardening

### SSL/TLS Configuration

Enable HTTPS for production deployments:

```bash
# SSL settings
FORCE_SSL=true
SSL_CERT_PATH=/path/to/cert.pem
SSL_KEY_PATH=/path/to/key.pem
```

### API Security

Configure rate limiting and authentication:

```bash
# Rate limiting
API_RATE_LIMIT_ENABLED=true
API_RATE_LIMIT_REQUESTS=1000
API_RATE_LIMIT_WINDOW=3600

# Authentication
JWT_SECRET_KEY=your-secret-key-here
JWT_ACCESS_TOKEN_EXPIRES=3600
```

## Monitoring and Logging

### Application Monitoring

Set up monitoring for production environments:

```bash
# Monitoring settings
ENABLE_METRICS=true
METRICS_PORT=9090
HEALTH_CHECK_ENDPOINT=/health
```

### Log Configuration

Configure logging levels and outputs:

```bash
# Logging settings
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_FILE_ROTATION=daily
LOG_RETENTION_DAYS=30
```

## Backup and Recovery

### Database Backup

Set up automated database backups:

```bash
# Backup configuration
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
BACKUP_RETENTION_DAYS=7
BACKUP_S3_BUCKET=dify-backups
```

### File Storage Backup

Configure file storage backup strategy:

```bash
# File backup settings
FILE_BACKUP_ENABLED=true
FILE_BACKUP_DESTINATION=s3://dify-file-backups
FILE_BACKUP_ENCRYPTION=true
```

## Scaling Considerations

### Horizontal Scaling

For high-traffic deployments, consider:

1. **Load Balancer Configuration**
2. **Database Clustering**
3. **Redis Clustering**
4. **Container Orchestration with Kubernetes**

### Vertical Scaling

Optimize resource allocation:

- Monitor CPU and memory usage
- Adjust worker counts based on load
- Implement auto-scaling policies

## Troubleshooting

### Common Issues

**High Memory Usage:**
- Check for memory leaks in custom tools
- Reduce worker memory limits
- Enable memory profiling

**Slow Response Times:**
- Optimize database queries
- Enable Redis caching
- Review API rate limits

**Connection Errors:**
- Verify network connectivity
- Check firewall settings
- Validate SSL certificates

## Next Steps

After completing the advanced setup:

1. Run performance benchmarks
2. Set up monitoring dashboards
3. Configure automated backups
4. Document your configuration

For additional support, refer to the [Troubleshooting Guide](/en/documentation/pages/debug/error-type) or contact the community.