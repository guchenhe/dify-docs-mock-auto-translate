---
title: "Deployment Guide"
description: "Learn how to deploy Dify applications in production"
icon: "rocket"
---

Deploying Dify applications to production requires careful consideration of infrastructure, security, and scalability. This guide covers the essential steps and best practices for production deployment.

## Overview

Dify supports multiple deployment approaches:
- **Cloud Deployment**: Deploy to major cloud providers
- **Self-Hosted**: Run on your own infrastructure
- **Docker**: Containerized deployment
- **Kubernetes**: Orchestrated container deployment

## Prerequisites

Before deploying, ensure you have:
- A configured Dify application
- Access to your deployment environment
- Required API keys and secrets
- SSL certificates for HTTPS

## Cloud Deployment Options

### AWS Deployment

Deploy to Amazon Web Services using their managed services:

```bash
# Install AWS CLI
curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"
unzip awscliv2.zip
sudo ./aws/install

# Configure AWS credentials
aws configure
```

**Recommended AWS Services:**
- **EC2**: For application hosting
- **RDS**: For database management
- **S3**: For file storage
- **CloudFront**: For CDN
- **ELB**: For load balancing

### Google Cloud Platform

Deploy using Google Cloud services:

```bash
# Install Google Cloud SDK
curl https://sdk.cloud.google.com | bash
exec -l $SHELL

# Initialize and authenticate
gcloud init
gcloud auth login
```

**Recommended GCP Services:**
- **Compute Engine**: For virtual machines
- **Cloud SQL**: For managed databases
- **Cloud Storage**: For file storage
- **Cloud CDN**: For content delivery

### Azure Deployment

Deploy to Microsoft Azure:

```bash
# Install Azure CLI
curl -sL https://aka.ms/InstallAzureCLIDeb | sudo bash

# Login to Azure
az login
```

## Docker Deployment

### Basic Docker Setup

Create a production-ready Docker configuration:

```dockerfile
FROM node:18-alpine

WORKDIR /app

# Copy package files
COPY package*.json ./
RUN npm ci --only=production

# Copy application code
COPY . .

# Set production environment
ENV NODE_ENV=production
ENV PORT=3000

# Expose port
EXPOSE 3000

# Health check
HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \
  CMD curl -f http://localhost:3000/health || exit 1

# Start application
CMD ["npm", "start"]
```

### Docker Compose for Production

```yaml
version: '3.8'

services:
  dify-app:
    build: .
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
      - DATABASE_URL=${DATABASE_URL}
      - DIFY_API_KEY=${DIFY_API_KEY}
    depends_on:
      - database
      - redis
    restart: unless-stopped

  database:
    image: postgres:15
    environment:
      - POSTGRES_DB=dify_prod
      - POSTGRES_USER=${DB_USER}
      - POSTGRES_PASSWORD=${DB_PASSWORD}
    volumes:
      - postgres_data:/var/lib/postgresql/data
    restart: unless-stopped

  redis:
    image: redis:7-alpine
    restart: unless-stopped

  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
      - ./ssl:/etc/ssl
    depends_on:
      - dify-app
    restart: unless-stopped

volumes:
  postgres_data:
```

## Kubernetes Deployment

### Kubernetes Manifests

Deploy using Kubernetes for better orchestration:

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: dify-app
spec:
  replicas: 3
  selector:
    matchLabels:
      app: dify-app
  template:
    metadata:
      labels:
        app: dify-app
    spec:
      containers:
      - name: dify-app
        image: your-registry/dify-app:latest
        ports:
        - containerPort: 3000
        env:
        - name: NODE_ENV
          value: "production"
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: dify-secrets
              key: database-url
        resources:
          requests:
            memory: "256Mi"
            cpu: "250m"
          limits:
            memory: "512Mi"
            cpu: "500m"
```

### Service Configuration

```yaml
apiVersion: v1
kind: Service
metadata:
  name: dify-app-service
spec:
  selector:
    app: dify-app
  ports:
  - protocol: TCP
    port: 80
    targetPort: 3000
  type: LoadBalancer
```

## Environment Configuration

### Production Environment Variables

```bash
# Application
NODE_ENV=production
PORT=3000

# Database
DATABASE_URL=postgresql://user:pass@host:5432/database

# API Keys
DIFY_API_KEY=your_production_api_key
OPENAI_API_KEY=your_openai_key

# Security
JWT_SECRET=your_jwt_secret
ENCRYPTION_KEY=your_encryption_key

# Monitoring
SENTRY_DSN=your_sentry_dsn
LOG_LEVEL=info
```

## Security Best Practices

### SSL/TLS Configuration

Always use HTTPS in production:

```nginx
server {
    listen 443 ssl http2;
    server_name yourdomain.com;
    
    ssl_certificate /path/to/certificate.crt;
    ssl_certificate_key /path/to/private.key;
    ssl_protocols TLSv1.2 TLSv1.3;
    
    location / {
        proxy_pass http://dify-app:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

### Security Headers

Implement security headers:

```javascript
app.use((req, res, next) => {
  res.setHeader('X-Content-Type-Options', 'nosniff');
  res.setHeader('X-Frame-Options', 'DENY');
  res.setHeader('X-XSS-Protection', '1; mode=block');
  res.setHeader('Strict-Transport-Security', 'max-age=31536000; includeSubDomains');
  next();
});
```

## Monitoring and Logging

### Application Monitoring

```javascript
// Health check endpoint
app.get('/health', (req, res) => {
  res.status(200).json({
    status: 'healthy',
    timestamp: new Date().toISOString(),
    uptime: process.uptime()
  });
});

// Metrics collection
app.get('/metrics', (req, res) => {
  // Prometheus metrics
  res.set('Content-Type', 'text/plain');
  res.send(prometheus.register.metrics());
});
```

### Log Management

```javascript
const winston = require('winston');

const logger = winston.createLogger({
  level: process.env.LOG_LEVEL || 'info',
  format: winston.format.json(),
  transports: [
    new winston.transports.File({ filename: 'error.log', level: 'error' }),
    new winston.transports.File({ filename: 'combined.log' }),
    new winston.transports.Console({
      format: winston.format.simple()
    })
  ]
});
```

## Performance Optimization

### Caching Strategy

```javascript
const redis = require('redis');
const client = redis.createClient(process.env.REDIS_URL);

// Cache API responses
app.get('/api/data', async (req, res) => {
  const cacheKey = `data:${req.user.id}`;
  
  try {
    const cached = await client.get(cacheKey);
    if (cached) {
      return res.json(JSON.parse(cached));
    }
    
    const data = await fetchData(req.user.id);
    await client.setex(cacheKey, 300, JSON.stringify(data));
    res.json(data);
  } catch (error) {
    logger.error('Cache error:', error);
    res.status(500).json({ error: 'Internal server error' });
  }
});
```

### Database Optimization

```sql
-- Create indices for better performance
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_conversations_user_id ON conversations(user_id);
CREATE INDEX idx_messages_conversation_id ON messages(conversation_id);

-- Enable connection pooling
-- Set in your DATABASE_URL or connection config
```

## Troubleshooting

### Common Issues

1. **Port conflicts**: Ensure ports are properly mapped
2. **Environment variables**: Verify all required variables are set
3. **Database connections**: Check connection strings and network access
4. **SSL certificate**: Validate certificate chain and expiration
5. **Resource limits**: Monitor CPU and memory usage

### Debugging Commands

```bash
# Check container logs
docker logs dify-app

# Check Kubernetes pod status
kubectl get pods
kubectl logs pod/dify-app-xxx

# Monitor resource usage
docker stats
kubectl top pods
```

## Next Steps

- Set up monitoring and alerting
- Implement automated backups
- Configure auto-scaling
- Set up CI/CD pipelines
- Plan disaster recovery

{/*
Contributing Section
DO NOT edit this section!
It will be automatically generated by the script.
*/}

---

[Edit this page](https://github.com/langgenius/dify-docs/edit/main/en/documentation/pages/getting-started/deployment-guide.mdx) | [Report an issue](https://github.com/langgenius/dify-docs/issues/new?template=docs.yml)